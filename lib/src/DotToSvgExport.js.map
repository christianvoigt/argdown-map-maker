{"version":3,"sources":["../../src/DotToSvgExport.js"],"names":["_","DotToSvgExport","config","previousSettings","settings","defaultsDeep","format","name","request","response","dotToSvg","dot","svg","module","exports"],"mappings":";;;;AAAA;;;;AACA;;IAAYA,C;;;;;;;;IAENC,c;;;0BACSC,M,EAAQ;AACf,gBAAIC,mBAAmB,KAAKC,QAA5B;AACA,gBAAI,CAACD,gBAAL,EAAuB;AACnBA,mCAAmB,EAAnB;AACH;AACD,iBAAKC,QAAL,GAAgBJ,EAAEK,YAAF,CAAe,EAAf,EAAmBH,MAAnB,EAA2BC,gBAA3B,CAAhB;AACA;AACA,iBAAKC,QAAL,CAAcE,MAAd,GAAuB,KAAvB;AACH;;;AACD,4BAAYJ,MAAZ,EAAoB;AAAA;;AAChB,aAAKK,IAAL,GAAY,gBAAZ;AACA,aAAKL,MAAL,GAAcA,MAAd;AACH;;;;4BACGM,O,EAASC,Q,EAAU;AACnB,gBAAID,QAAQE,QAAZ,EAAsB;AAClB,qBAAKR,MAAL,GAAcM,QAAQE,QAAtB;AACH,aAFD,MAEO,IAAIF,QAAQP,cAAZ,EAA4B;AAC/B,qBAAKC,MAAL,GAAcM,QAAQP,cAAtB;AACH;AACD,gBAAI,CAACQ,SAASE,GAAd,EAAmB;AACf,uBAAOF,QAAP;AACH;AACDA,qBAASG,GAAT,GAAe,mBAAIH,SAASE,GAAb,EAAkB,KAAKP,QAAvB,CAAf;AACA,mBAAOK,QAAP;AACH;;;;;;AAELI,OAAOC,OAAP,GAAiB;AACbb,oBAAgBA;AADH,CAAjB","file":"DotToSvgExport.js","sourcesContent":["import Viz from 'viz.js';\nimport * as _ from 'lodash';\n\nclass DotToSvgExport {\n    set config(config) {\n        let previousSettings = this.settings;\n        if (!previousSettings) {\n            previousSettings = {};\n        }\n        this.settings = _.defaultsDeep({}, config, previousSettings);\n        // enforce svg export\n        this.settings.format = 'svg';\n    }\n    constructor(config) {\n        this.name = \"DotToSvgExport\";\n        this.config = config;\n    }\n    run(request, response) {\n        if (request.dotToSvg) {\n            this.config = request.dotToSvg;\n        } else if (request.DotToSvgExport) {\n            this.config = request.DotToSvgExport;\n        }\n        if (!response.dot) {\n            return response;\n        }\n        response.svg = Viz(response.dot, this.settings);\n        return response;\n    }\n}\nmodule.exports = {\n    DotToSvgExport: DotToSvgExport\n}\n"]}